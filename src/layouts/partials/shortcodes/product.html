{{- $context := . -}}
{{- $note := .note | default "<br/>" -}}
{{- $title := .title -}}
{{- $section := .section -}}
{{- $quantityMinimum := .quantityMinimum -}}
{{- $quantityRecommended := .quantityRecommended -}}

{{- $slug := print "products-" $section "-" $title | urlize -}}

{{ $directory := "static/images/" }}
{{ $filename := print $slug ".jpg" }}

{{ $image := "" }}
{{ if (where (readDir $directory) "Name" $filename) }}
  {{ $image = print "/images/" $slug ".jpg" }}
{{ else }}
  {{ $image = "/images/money-fire.jpg" }}
{{ end }}

{{ $categoryItems := index site.Data.links.products $section }}
{{ $subcategoryItems := index $categoryItems $title }}
{{ $genericLinks := index $subcategoryItems "Generic" }}
{{ $maleLinks := index $subcategoryItems "Male" }}
{{ $femaleLinks := index $subcategoryItems "Female" }}

<div class="product" id="{{ $slug }}">
    <div class="product-image">
        <img src="{{ $image }}"/>
    </div>
    <div class="product-details">
        <div class="product-title"><p>{{ $title }}</p></div>
        <div class="product-note"><p>{{ $note | markdownify }}</p></div>
        <div class="product-quantities">
            <p class="product-quantity"><strong>Minimum: </strong><span>{{ $quantityMinimum }}</p>
            <p class="product-quantity"><strong>Recommended: </strong><span>{{ $quantityRecommended }}</span></p>
        </div>
        <div class="product-links">
            {{- if $genericLinks -}}
              <div class="product-links-category">
                <p class="product-links-type"><svg fill="currentColor" height="18px" width="18px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 122.88 122.88"><title>hyperlink</title><path d="M60.54,34.07A7.65,7.65,0,0,1,49.72,23.25l13-12.95a35.38,35.38,0,0,1,49.91,0l.07.08a35.37,35.37,0,0,1-.07,49.83l-13,12.95A7.65,7.65,0,0,1,88.81,62.34l13-13a20.08,20.08,0,0,0,0-28.23l-.11-.11a20.08,20.08,0,0,0-28.2.07l-12.95,13Zm14,3.16A7.65,7.65,0,0,1,85.31,48.05L48.05,85.31A7.65,7.65,0,0,1,37.23,74.5L74.5,37.23ZM62.1,89.05A7.65,7.65,0,0,1,72.91,99.87l-12.7,12.71a35.37,35.37,0,0,1-49.76.14l-.28-.27a35.38,35.38,0,0,1,.13-49.78L23,50A7.65,7.65,0,1,1,33.83,60.78L21.12,73.49a20.09,20.09,0,0,0,0,28.25l0,0a20.07,20.07,0,0,0,28.27,0L62.1,89.05Z"/></svg></p>
                <div class="product-links-group">
                  {{- range $genericLinks -}}
                    <a href="{{ . }}">
                        <img
                          alt="{{ $title }}"
                          class="visible-when-dark"
                          src="/images/{{ if in . "amazon.com" }}logo-amazon-dark.png{{ else if in . "shopmyexchange" }}logo-aafes-dark.png{{ end }}"
                        />
                        <img
                          alt="{{ $title }}"
                          class="visible-when-light"
                          src="/images/{{ if in . "amazon.com" }}logo-amazon.png{{ else if in . "shopmyexchange" }}logo-aafes.png{{ end }}"
                        />
                    </a>
                  {{- end -}}
                </div>
              </div>
            {{- end -}}
            {{- if $maleLinks -}}
              <div class="product-links-category">
                <p class="product-links-type">♂</p>
                <div class="product-links-group">
                  {{- range $maleLinks -}}
                    <a href="{{ . }}">
                        <img
                          alt="{{ $title }}"
                          class="visible-when-dark"
                          src="/images/{{ if in . "amazon.com" }}logo-amazon-dark.png{{ else if in . "shopmyexchange" }}logo-aafes-dark.png{{ end }}"
                        />
                        <img
                          alt="{{ $title }}"
                          class="visible-when-light"
                          src="/images/{{ if in . "amazon.com" }}logo-amazon.png{{ else if in . "shopmyexchange" }}logo-aafes.png{{ end }}"
                        />
                    </a>
                  {{- end -}}
                </div>
              </div>
            {{- end -}}
            {{- if $femaleLinks -}}
              <div class="product-links-category">
              <p class="product-links-type">♀</p>
              <div class="product-links-group">
                {{- range $femaleLinks -}}
                  <a href="{{ . }}">
                      <img
                        alt="{{ $title }}"
                        class="visible-when-dark"
                        src="/images/{{ if in . "amazon.com" }}logo-amazon-dark.png{{ else if in . "shopmyexchange" }}logo-aafes-dark.png{{ end }}"
                      />
                      <img
                        alt="{{ $title }}"
                        class="visible-when-light"
                        src="/images/{{ if in . "amazon.com" }}logo-amazon.png{{ else if in . "shopmyexchange" }}logo-aafes.png{{ end }}"
                      />
                  </a>
                {{- end -}}
              </div>
            </div>
            {{- end -}}
        </div>
    </div>
</div>
